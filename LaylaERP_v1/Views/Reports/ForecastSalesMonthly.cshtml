
@{
    ViewBag.Title = "ForecastSalesMonthly";
}


@{
    ViewBag.Title = "WisconsinReport";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<!-- datatables CSS -->
<link href="~/Content/AdminLTE-3.1.0/datatables/DataTables-1.10.20/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
<link href="~/Content/AdminLTE-3.1.0/datatables/Buttons-1.6.1/css/buttons.dataTables.min.css" rel="stylesheet" />
<!-- datatables js -->
<script src="~/Content/AdminLTE-3.1.0/datatables/datatables.min.js" type="text/javascript"></script>
<script src="~/Content/AdminLTE-3.1.0/datatables/DataTables-1.10.20/js/dataTables.bootstrap4.min.js" type="text/javascript"></script>
<div class="page-title">
    <h2>Forecast sales (Monthly)</h2>
</div>
<section class="content content-section p-0 reports-section arizona-box not-fixed">
    <div class="row index_col_row">
        <div class="col-md-3">
            <div class="form-group">
                <label>Current year</label><span style="color:red">*</span>
                <select class="form-control" id="year">
                    <option value="">Year</option>
                </select>
            </div>
        </div>
        <div class="col-md-3">
            <div class="form-group">
                <label>Next year</label>
                <select class="form-control" id="nextyear">
                </select>
            </div>
        </div>
        <div class="col-md-3">
            <div class="form-group">
                <br /><br />
                <button id="filtersrchexp" class="button">Filter</button>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <div class="box box-primary">
                <div class="box-header">
                    <table id="dtdata" class="table-blue table check-table table-bordered table-striped dataTable " width="100%">
                        <thead>
                            <tr>
                                <th style="display:none">Month</th>
                                <th>Month name</th>
                                <th>Sales</th>
                                <th>Forecast sales (Sales + 10% of sales)</th>
                                <th>Lower confidence bound (Sales - 10% of sales)</th>
                                <th>Upper confidence bound (Forecast sales + 10% of forecast sales)</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function () {
            $("#filtersrchexp").click(function () {
                if ($("#year").val() == "") {
                    swal('Alert', 'Please select current year', 'error').then(function () { swal.close(); $('#year').focus(); });
                }
                else {

                    DatagridOrder();
                    return false;
                }
            });
            globalcurrentyear('year');
            globalnextyear('nextyear');
        });

        function globalcurrentyear(yearcount) {
            var currentYear = new Date().getFullYear();
            var yearSelect = document.getElementById(yearcount);
            for (var i = 0; i < 1; i++) {
                var isSelected = currentYear === currentYear - i
                yearSelect.options[yearSelect.options.length] = new Option(currentYear - i, currentYear - i, isSelected, isSelected);
            }
        }

        function globalnextyear(yearcount) {
            var currentYear = new Date().getFullYear() + 1;
            var yearSelect = document.getElementById(yearcount);
            for (var i = 0; i < 1; i++) {
                var isSelected = currentYear === currentYear - i
                yearSelect.options[yearSelect.options.length] = new Option(currentYear - i, currentYear - i, isSelected, isSelected);
            }
        }

        function DatagridOrder() {
            var Year = $("#year").val();
            $('#dtdata').DataTable({
                destroy: true,
                "scrollX": true,
                searching: false,
                "ajax": {
                    "url": '/Reports/GetForecastSalesMonthly',
                    "type": 'POST',
                    "dataType": 'json',
                    "data": { Year: Year }
                    //"data": JSON.stringify(obj)
                },
                "columns": [
                    { 'data': 'tax', 'sWidth': "15%", 'class': 'text-right' },
                    { 'data': 'shipping_amount', 'sWidth': "15%", 'class': 'text-right'},
                    { 'data': 'handling_amount', 'sWidth': "10%", 'class': 'text-right' },
                    { 'data': 'first_name', 'sWidth': "10%", 'class': 'text-right' },
                    { 'data': 'Discount', 'sWidth': "10%", 'class': 'text-right' },
                    { 'data': 'total', 'sWidth': "10%", 'class': 'text-right' }

                ],

                columnDefs: [
                    {
                        targets: [0],
                        visible: false
                    }
                ],

                "order": [0, 'asc'],
            });
        }
    </script>
</section>



