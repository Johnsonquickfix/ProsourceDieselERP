@{
    ViewBag.Title = "List Financial Accounts";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="~/Content/DataTables/bootstrap-datepicker.css" rel="stylesheet" />
<script src="~/Content/DataTables/bootstrap-datepicker.js"></script>


<div class="page-title">
    <h2>Bank Accounts</h2>
    <a class="btn btn-danger" href="../newfinaccount">Add Account</a>
</div>
<section class="content section-content massstocktransfer commercial_proposal mt-1" id="bank_account_section">
    <div class="nav-tabs-custom">
        <ul class="nav nav-tabs">
            <li class="active"><a href="#tab_1" data-toggle="tab">Bank account</a></li>
            <li><a href="#tab_2" data-toggle="tab">Bank entries</a></li>
            <li><a href="#tab_3" data-toggle="tab">Planned entries</a></li>
            <li><a href="#tab_4" data-toggle="tab">Monthly reporting</a></li>
            <li><a href="#tab_6" data-toggle="tab">Account statements</a></li>
            <li><a href="#tab_7" data-toggle="tab">Linked files</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane active" id="tab_1">
                <div class="box box-primary">
                    @*<div class="box-header">*@
                    @*<div class="d-flex proposal-top">
                            <div class="edit-proposal-box">
                                <div class="proposal-box">
                                    <input type="file" name="file" id="proposal" class="inputfile">
                                    <label for="proposal"><i class="fas fa-landmark"></i></label>
                                </div>
                                <div class="edit-proposal-texts">
                                    <h3 class="box-title">#101</h3>
                                    <p>Capital One</p>
                                    <p><i class="fas fa-map-marker-alt" aria-hidden="true"></i>United States</p>
                                </div>
                            </div>
                            <div class="back-to-list">
                                <p><button class="btn btn-danger">Back to list</button></p>
                                <p><button class="btn btn-danger">Open</button></p>
                            </div>
                        </div>*@
                    @*</div>*@
                </div>

                <div class="row" style="background-color:white">
                    <div class="col-md-4">
                        <input type="hidden" id="hfid" />
                        <div class="form-group">
                            <label for="bankcash">Bank or Cash Label</label><span style="color:red">*</span>
                            <input type="text" class="form-control" id="txtbankcashlabel" placeholder="Enter Bank or Cash Label">
                        </div>
                        <div class="form-group">
                            <label for="accounttype">Account Type</label><span style="color:red">*</span>
                            <select class="form-control" id="txtaccounttype">
                                <option value="1">Saving Account</option>
                                <option value="2">Current or Credit Card Account</option>
                                <option value="3">Cash Account</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="bankstatus">Status</label><span style="color:red">*</span>
                            <select class="form-control" id="txtbankstatus">
                                <option value="1">Open</option>
                                <option value="0">Close</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="accountcountry">Account Country</label><span style="color:red">*</span>
                            <select class="form-control" id="txtaccountcountry">
                                <option selected value="US">United States</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="state">State/Province</label><span style="color:red">*</span>
                            <input class="form-control" type="text" id="txtstate" />
                            @*<select class="form-control" id="txtstate">
                                <option selected value="NY">New York</option>
                            </select>*@
                        </div>

                        <div class="form-group">
                            <label for="tag">Web</label><span style="color:red">*</span>
                            <input class="form-control" type="text" id="txtweb" />
                        </div>

                        <div class="form-group">
                            <label for="tag">Comment</label><span style="color:red">*</span>
                            <input class="form-control" type="text" id="txtcomment" />
                        </div>

                        <div class="form-group">
                            <label for="tag">Initial balance</label><span style="color:red">*</span>
                            <input type="text" class="form-control" id="txtinitial" />
                        </div>

                    </div>

                    <div class="col-sm-4">


                        <div class="form-group">
                            <label for="tag">Date</label><span style="color:red">*</span>
                            <input type="text" class="form-control" id="txtdate" /><span class="even-space"></span>
                        </div>

                        <div class="form-group">
                            <label for="tag">Minimum allowed balance</label><span style="color:red">*</span>
                            <input type="text" class="form-control" id="txtminallowbalance" />
                        </div>

                        <div class="form-group">
                            <label for="tag">Minimum desired balance</label><span style="color:red">*</span>
                            <input type="text" class="form-control" id="txtdesiredbalance" />
                        </div>


                        <div class="form-group">
                            <label for="tag">Bank name</label><span style="color:red">*</span>
                            <input type="text" class="form-control" id="txtbankname" />
                        </div>

                        <div class="form-group">
                            <span style="color:red">*</span>
                            <label for="tag">Bank Code</label><span style="color:red">*</span>
                            <input type="text" class="form-control" id="txtbankcode" />
                        </div>

                        <div class="form-group">
                            <span style="color:red">*</span>
                            <label for="tag">Account Number</label>
                            <input type="text" class="form-control" id="txtaccountnumber" />
                        </div>

                        <div class="form-group">
                            <span style="color:red">*</span>
                            <label for="tag">IBAN Account Number</label>
                            <input type="text" class="form-control" id="txtIBAN" />
                        </div>

                        <div class="form-group">
                            <label for="tag">BIC/SWIFT code</label><span style="color:red">*</span>
                            <input type="text" class="form-control" id="txtBIC" />
                        </div>

                    </div>

                    <div class="col-sm-4">

                        <div class="form-group">
                            <label for="tag">Currency</label><span style="color:red">*</span>
                            <input type="text" class="form-control" id="txtcurrency" value="USD" />
                        </div>

                        <div class="form-group"><span style="color:red">*</span>
                            <label for="tag">Bank address</label>
                            <input type="text" class="form-control" id="txtbankaddress" />
                        </div>

                        <div class="form-group"><span style="color:red">*</span>
                            <label for="tag">Account owner name</label>
                            <input type="text" class="form-control" id="txtaccountowner" />
                        </div>

                        <div class="form-group"><span style="color:red">*</span>
                            <label for="tag">Account owner address</label>
                            <input type="text" class="form-control" id="txtowneraddress" />
                        </div>
                        <div class="form-group">
                            <label for="tag">Accounting Account</label><span style="color:red">*</span>
                            <select class="form-control" id="ddlaccounting">
                                @*<option value="1">Assets</option>*@
                            </select>
                        </div>

                        <div class="form-group"><span style="color:red">*</span>
                            <label for="tag">Accounting code journal</label>
                            <select class="form-control" id="ddljournal">
                                @*<option value="1">JR</option>*@
                            </select>
                        </div>

                        <a href="#" class="btn btn-danger" id="btnSave"><b>Update</b></a>
                        @Html.ActionLink("Back to List", "BankAccountList", null, new { @class = "btn btn-danger" })
                    </div>


                </div>
            </div>


            <!--Tab 1 End -->
            <div class="tab-pane" id="tab_2">
                @*<div class="box box-primary">
                    <div class="box-header">
                        <div class="d-flex proposal-top">
                            <div class="edit-proposal-box">
                                <div class="proposal-box">
                                    <input type="file" name="file" id="proposal" class="inputfile">
                                    <label for="proposal"><i class="fas fa-landmark"></i></label>
                                </div>
                                <div class="edit-proposal-texts">
                                    <h3 class="box-title">#101</h3>
                                    <p>Capital One</p>
                                    <p><i class="fas fa-map-marker-alt" aria-hidden="true"></i>United States</p>
                                </div>
                            </div>
                            <div class="back-to-list">
                                <p><button class="btn btn-danger">Back to list</button></p>
                                <p><button class="btn btn-danger">Open</button></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row rowbox proposal-row">
                    <div class="col-md-12">
                        <div class="box box-primary">
                            <div class="box-header">
                                <h3 class="box-title">
                                    Bank entries <span class="badge">6</span>
                                </h3>
                            </div>
                            <div class="box-body">
                                <div class="table-responsive bank-table-wrapper">
                                    <table id="dtdata" class="table-blue table check-table table-bordered table-striped">
                                        <thead>
                                            <tr>
                                                <th>Ref.</th>
                                                <th>Description</th>
                                                <th>Oper. Date</th>
                                                <th>Value date</th>
                                                <th>Type</th>
                                                <th>Number</th>
                                                <th>Third-party/User</th>
                                                <th>Bank account</th>
                                                <th>Debit</th>
                                                <th>Credit</th>
                                                <th>Balance</th>
                                                <th>Account statement</th>
                                                <th>&nbsp;</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><span class="ws_nowrap"><i class="fas fa-receipt"></i>- 13</span></td>
                                                <td><span class="ws_nowrap"><i class="fas fa-money-check-alt"></i>Vendor payment</span></td>
                                                <td>08/09/2021</td>
                                                <td>08/09/2021</td>
                                                <td>Credit card</td>
                                                <td>&nbsp;</td>
                                                <td>Hangzhou Pinhang Home Textile Co.,Ltd (Home Tex)</td>
                                                <td>#101</td>
                                                <td>54,434.14</td>
                                                <td>&nbsp;</td>
                                                <td>-6,684.14</td>
                                                <td>&nbsp;</td>
                                                <td>
                                                    <span class="ws_nowrap">
                                                        <a href="#">
                                                            <i class="fas fa-pencil-alt"></i>
                                                        </a>
                                                        <a href="#">
                                                            <i class="fas fa-trash marginleftonly"></i>
                                                        </a>
                                                    </span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="box-footer text-right">
                                <button class="btn btn-danger">Modify</button>
                            </div>
                        </div>
                    </div>
                </div>*@
            </div>
            <div class="tab-pane" id="tab_3">
                @*<div class="box box-primary">
                    <div class="box-header">
                        <div class="d-flex proposal-top">
                            <div class="edit-proposal-box">
                                <div class="proposal-box">
                                    <input type="file" name="file" id="proposal" class="inputfile">
                                    <label for="proposal"><i class="fas fa-landmark"></i></label>
                                </div>
                                <div class="edit-proposal-texts">
                                    <h3 class="box-title">#101</h3>
                                    <p>Capital One</p>
                                    <p><i class="fas fa-map-marker-alt" aria-hidden="true"></i>United States</p>
                                </div>
                            </div>
                            <div class="back-to-list">
                                <p><button class="btn btn-danger">Back to list</button></p>
                                <p><button class="btn btn-danger">Open</button></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row rowbox proposal-row">
                    <div class="col-md-12">
                        <div class="box box-primary">
                            <div class="box-header">
                                <h3 class="box-title">
                                    Bank entries <span class="badge">6</span>
                                </h3>
                            </div>
                            <div class="box-body">
                                <div class="table-responsive bank-table-wrapper">
                                    <table id="dtdata" class="inventory-table table-blue table check-table table-bordered table-striped">
                                        <tbody>
                                            <tr>
                                                <td>Due date</td>
                                                <td>Description</td>
                                                <td>Third-party</td>
                                                <td>Debit</td>
                                                <td>Credit</td>
                                                <td class="text-right">Balance</td>
                                            </tr>
                                            <tr>
                                                <td class="text-left" colspan="5">Current balance</td>
                                                <td class="ws_nowrap text-right">-6,684.14</td>
                                            </tr>
                                            <tr>
                                                <td class="text-left" colspan="5">Remaining unpaid</td>
                                                <td class="ws_nowrap text-right">&nbsp;</td>
                                            </tr>
                                            <tr>
                                                <td>08/09/2021</td>
                                                <td>SI2108-0002</td>
                                                <td>FXI</td>
                                                <td class="ws_nowrap text-right">50,794.00</td>
                                                <td>&nbsp;</td>
                                                <td class="ws_nowrap text-right">-57,478.14</td>
                                            </tr>
                                            <tr>
                                                <td>08/09/2021</td>
                                                <td>SI2108-0002</td>
                                                <td>FXI</td>
                                                <td class="ws_nowrap text-right">50,794.00</td>
                                                <td>&nbsp;</td>
                                                <td class="ws_nowrap text-right">-57,478.14</td>
                                            </tr>
                                            <tr>
                                                <td class="text-left" colspan="5">Future balance (USD)</td>
                                                <td class="ws_nowrap text-right">$-57,560.96</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>*@
            </div>
            <div class="tab-pane" id="tab_4">
                @*<h2 class="box-title">Monthly reporting</h2>*@
            </div>
            <div class="tab-pane" id="tab_6">
                @*<h2 class="box-title">Account statements</h2>*@
            </div>
            <div class="tab-pane" id="tab_7">
                @*<div class="box box-primary">
                    <div class="box-header">
                        <div class="d-flex proposal-top">
                            <div class="edit-proposal-box">
                                <div class="proposal-box">
                                    <input type="file" name="file" id="proposal" class="inputfile">
                                    <label for="proposal"><i class="fas fa-landmark"></i></label>
                                </div>
                                <div class="edit-proposal-texts">
                                    <h3 class="box-title">#101</h3>
                                    <p>Capital One</p>
                                    <p><i class="fas fa-map-marker-alt" aria-hidden="true"></i>United States</p>
                                </div>
                            </div>
                            <div class="back-to-list">
                                <p><button class="btn btn-danger">Back to list</button></p>
                                <p><button class="btn btn-danger">Open</button></p>
                            </div>
                        </div>
                    </div>
                    <div class="box-body">
                        <table class="table-blue table check-table table-bordered inventory-table fixed-table">
                            <tbody>
                                <tr>
                                    <td class="titlefield">Number of attached files/documents</td>
                                    <td class="text-left" colspan="3">0</td>
                                </tr>
                                <tr>
                                    <td class="titlefield">Total size of attached files/documents</td>
                                    <td class="text-left" colspan="3">0 b.</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="row rowbox proposal-row">
                    <div class="col-md-12">
                        <div class="box box-primary">
                            <div class="box-header with-border">
                                <label class="control-label">Attach a new file/document</label>
                                <div class="col-sm-12">
                                    <form class="form-inline">
                                        <div class="form-group align-items-end file-group">
                                            <input class="form-control-file file_input_elem" type="file" multiple="" accept="">
                                            <input type="submit" class="btn btn-danger" name="sendit" value="Upload">
                                        </div>
                                    </form>
                                </div>
                            </div>
                            <div class="box-header">
                                <label class="control-label">Link a new file/document</label>
                                <div class="col-sm-12">
                                    <form class="form-inline">
                                        <div class="form-group align-items-center file-group">
                                            <input type="text" class="form-control" " placeholder="Url to Link">
                                            <input type="text" class="form-control" placeholder="Label">
                                            <button type="submit" class="btn btn-danger">Link</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            <div class="box-body">
                                <div class="mb-35">
                                    <label class="control-label">Attached files and documents</label>
                                    <div class="table-responsive bank-table-wrapper">
                                        <table class="inventory-table table-blue table check-table table-bordered table-striped">
                                            <thead>
                                                <tr>
                                                    <th>Documents</th>
                                                    <th>Size</th>
                                                    <th>Date</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>
                                <div class="mb-35">
                                    <label class="control-label">Linked files and documents</label>
                                    <div class="table-responsive bank-table-wrapper">
                                        <table class="inventory-table table-blue table check-table table-bordered table-striped">
                                            <thead>
                                                <tr>
                                                    <th>Linked</th>
                                                    <th>Date</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>*@
            </div>
        </div>
    </div>
</section>


<script>
    $(document).ready(function () {
        var url = window.location.pathname;
        var id = url.substring(url.lastIndexOf('/') + 1);
        GetAccountByID(id);

        $(document).on('click', "#btnSave", function () {
            UpdateBankAccount();
        });
    });


</script>




<script>
    function GetAccountByID(id) {
        var rowid = id;
        var obj =
            $.ajax({
                url: "/Bank/GetAccountByID/" + rowid,
                type: "GET",
                contentType: "application/json; charset=utf-8",
                dataType: 'JSON',
                data: JSON.stringify(obj),
                success: function (data) {
                    //console.log(data);

                    var d = JSON.parse(data);
                    if (d.length > 0) {
                        $("#hfid").val(d[0].rowid);
                        $("#txtbankcashlabel").val(d[0].label);
                        $("#txtaccounttype").val(d[0].account_type);
                        $("#txtbankstatus").val(d[0].working_status);
                        $("#txtaccountcountry").val(d[0].country_iban);
                        $("#txtstate").val(d[0].state);
                        $("#txtweb").val(d[0].url);
                        $("#txtcomment").val(d[0].comment);
                        $("#txtinitial").val(d[0].initial_balance);
                        $("#txtdate").val(d[0].date_created);
                        $("#txtminallowbalance").val(d[0].min_allowed);
                        $("#txtdesiredbalance").val(d[0].min_desired);
                        $("#txtbankname").val(d[0].bank);
                        $("#txtbankcode").val(d[0].code_bank);
                        $("#txtaccountnumber").val(d[0].account_number);
                        $("#txtIBAN").val(d[0].iban_prefix);
                        $("#txtBIC").val(d[0].bic);
                        $("#txtbankaddress").val(d[0].bank_address);
                        $("#txtaccountowner").val(d[0].owner_name);
                        $("#txtowneraddress").val(d[0].owner_address);
                        $("#ddlaccounting").val(d[0].accounting_number);
                        $("#ddljournal").val(d[0].fk_accountancy_journal);
                        $("#txtcurrency").val(d[0].currency_code);


                        //console.log(d[0].rowid);
                    }
                },
                error: function (msg) {

                }
            });

    }
</script>

<script src="@Url.Content("~/js/Bank/Bank.js?v="+DateTime.Now.ToString("ddMMyyyymmss")+"")" asp-append-version="true"></script>

<script>
    $(function () {
        $("#txtdate").datepicker({
            format: 'mm-dd-yyyy',
        });

    });
</script>
