@model LaylaERP.Models.GiftCardModel

@{
    ViewBag.Title = "Gift Card";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="page-title">
    <h2 class="page-heading">Billing Details</h2>
</div>

<section class="content content-section p-0">
    
    <div class="box box-primary">
        <div class="box-header with-border">
            <input type="hidden" id="hfOrderNo" value="@ViewBag.id" />
            <h4 class="box-title" id="lblOrderNo" data-pay_option="@ViewBag.pay_option" data-pname="Layla E-Gift Card" data-pay_by="" data-pay_id="">Order #000000 detail</h4>
            <div class="radtype_span">
                <h5 class="payment-history"></h5>
            </div>
            <div class="box-tools pull-right box-tools-header"></div>
        </div>
        <div class="box-body">
            <div class="form-horizontal create-new-customer" id="parent">
                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="control-label " for="Email">Email</label>
                            <div class="">
                                <input type="email" id="txtSenderEmail" class="form-control" value="@Model.sender_email" placeholder="Email" disabled />
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label " for="First Name">First Name</label>
                            <div class="">
                                <input type="text" id="txtFirstName" class="form-control" placeholder="First Name" value="@Model.FirstName" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label " for="Last Name">Last Name</label>
                            <div class="">
                                <input type="text" id="txtLastName" class="form-control" placeholder="Last Name" value="@Model.LastName" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label " for="Contact No.">Contact No.</label>
                            <div class="">
                                <input type="tel" id="txtPhone" class="form-control" placeholder="Contact No." value="@Model.PhoneNumber" />
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="control-label " for="Company">Company</label>
                            <div class="">
                                <input type="text" id="txtCompany" class="form-control" placeholder="Company" value="@Model.Company" />
                            </div>
                        </div>
                        <div class="form-group">
                            <img class="sb-title-icon" src="https://fonts.gstatic.com/s/i/googlematerialicons/location_pin/v5/24px.svg" alt="">
                            <label class="control-label " for="Address 1">Address</label>
                            <div class="">
                                <input type="text" id="txtAddress1" class="form-control" placeholder="Address" value="@Model.Address" autocomplete="off" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label " for="Address 2">Address Line 2</label>
                            <div class="">
                                <input type="text" id="txtAddress2" class="form-control" placeholder="Address Line 2" value="@Model.Address2" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label " for="City">City</label>
                            <div class="">
                                <input type="tel" id="txtCity" class="form-control" placeholder="City" value="@Model.City" />
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label for="exampleInputEmail1">State</label>
                            <select class="form-control" id="ddlState" value="@Model.State">
                                <option selected value=""></option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="control-label " for="Post/Zip Code">Zip Code</label>
                            <div class="">
                                <input type="text" id="txtPostCode" class="form-control" placeholder="Zip Code" value="@Model.Zipcode" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputEmail1">Country</label>
                            <select class="form-control" id="ddlCountry" value="@Model.Country">
                                <option value="US">US - United States</option>
                                <option value="CA">CA - Canada</option>
                            </select>
                        </div>

                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="box box-primary">
                        <div class="box-header">
                            <div class="row">
                                <div class="col-sm-12">
                                    <table id="EmployeeListdata" data-orderitemid="0" data-productid="0" data-recipientlist="@Model.recipient" class="inventory-table table-blue table check-table table-bordered table-striped dataTable " width="100%">
                                        <thead>
                                            <tr>
                                                <th>Item Name</th>
                                                <th>Email</th>
                                                <th>amount</th>
                                            </tr>

                                        </thead>
                                        @foreach (string list in Model.recipientList)
                                        {
                                            <tbody id="GiftCard_List">
                                                <tr data-orderitemid="0">
                                                    <td width="40%" class="text-left" id="lst_productName">Layla E-Gift Card</td>
                                                    <td width="40%" id="lst_recipient">@list</td>
                                                    <td width="30%" id="lst_amount">$@Model.amount.ToString("0.00")</td>
                                                </tr>
                                            </tbody>
                                        }
                                    </table>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <!-- order-notes -->
                    <div class="box box-primary direct-chat">
                        <div class="box-header with-border">
                            <h3 class="box-title">Order Notes</h3>
                            <div class="box-tools pull-right">
                                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                            </div>
                        </div>

                        <div class="box-footer" style="">
                            <div class="form-group">
                                <label>Add note</label>
                                <textarea type="text" name="order_note" id="txtOrderNotes" class="form-control billnote" rows="3" value="@Model.message">@Model.message</textarea>
                            </div>
                        </div>
                        <!-- /.box-footer-->
                    </div>
                    <!-- /.order-notes -->
                </div>
                <div class="col-sm-6 checkout-box-total">
                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <h3 class="box-title">Total</h3>
                            <div class="box-tools pull-right">
                                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                            </div>
                        </div>
                        <div class="box-body text-right">
                            <div id="order_final_total">
                                <div class="form-group">
                                    <label class="col-sm-10 control-label">Sub-Total (<span id="totalQty">@Model.qty</span>)</label>
                                    <div class="col-sm-2 controls text-right">
                                        @{ var x = Model.amount * Model.qty; }
                                        $<span id="SubTotal" data-amount="@Model.amount">@x.ToString("0.00")</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-10 control-label">Shipping</label>
                                    <div class="col-sm-2 controls text-right">
                                        $<span id="shippingTotal" data-orderitemid="0">0.00</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-10 control-label">Tax</label>
                                    <div class="col-sm-2 controls text-right">
                                        $<span id="salesTaxTotal" data-orderitemid="0">0.00</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-10 control-label">Order Total</label>
                                    <div class="col-sm-2 controls text-right">
                                        <strong>$<span id="orderTotal">@x.ToString("0.00")</span></strong>
                                    </div>
                                </div>
                                @*<div class="form-group refund-total hidden">
                                    <label class="col-sm-10 control-label">Refunded</label>
                                    <div class="col-sm-2 controls text-right text-red text-weight-bold">
                                        <strong>$<span id="refundedTotal" data-orderitemid="0">0.00</span></strong>
                                    </div>
                                </div>
                                <div class="form-group refund-total hidden">
                                    <label class="col-sm-10 control-label">Net Payment</label>
                                    <div class="col-sm-2 controls text-right text-weight-bold">
                                        <strong>$<span id="netPaymentTotal" data-orderitemid="0">0.00</span></strong>
                                    </div>
                                </div>*@
                            </div>
                        </div>
                        <!-- /.box-body -->

                    </div>
                </div>
            </div>
        </div>
        <div class="box-footer">
            <div class="text-right">
                <span title="Click Here To Checkout" data-placement="bottom" data-toggle="tooltip"><input type="submit" value="Checkout" id="btnOrderCheckout" class="btn btn-danger" /></span>
            </div>
        </div>
        <!-- /.row -->
    </div>
    <div class="map" id="map" style="display:none;"></div>
</section>
<div class="modal in printable " id="GiftModal" role="dialog" aria-hidden="true"></div>

<script src="~/js/jquery.mask.js" asp-append-version="true"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDxgkt6GqQuQK2Gb3PYFnicpFLmma-7i0A&libraries&callback=initMap&libraries=places&v=weekly" async></script>
<script src="@Url.Content("~/js/Giftcard/GiftcardOrder.js?v="+DateTime.Now.ToString("ddMMyyyymmss")+"")" asp-append-version="true"></script>

<script>
    $(document).ready(function () {
        $("#ddlState").select2({
            allowClear: true, minimumInputLength: 2, placeholder: "Search State",
            ajax: {
                url: '/Users/GetCustState', type: "POST", contentType: "application/json; charset=utf-8", dataType: 'json', delay: 250,
                data: function (params) {
                    var obj = { strValue1: params.term, strValue2: $("#ddlCountry").val() };
                    return JSON.stringify(obj);
                },
                processResults: function (data) {
                    var jobj = JSON.parse(data);
                    console.log(jobj);
                    return {
                        results: $.map(jobj, function (item) {
                            return { text: item.StateFullName, name: item.StateFullName, id: item.State }
                        })
                    };
                },
                error: function (xhr, status, err) { }, cache: true
            }
        });

        $('#txtPostCode').change(function () {
            City = $("#ddlCity").val();
            State = $("#ddlState").val();
            PostalCode = $("#txtPostCode").val();
            var obj = {
                billing_state: State, billing_city: City, billing_postcode: PostalCode
            }
            $.ajax({
                url: '/Users/CityStateZip/', dataType: 'json', type: 'Post',
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify(obj),
                dataType: "json",
                success: function (data) {
                    if (data.status == true) {
                        $('#hfzipstatus').val(data.status);
                    } else {
                        if ($('#ddlCountry').val() == "US") {
                            $("#txtPostCode").val("");
                            $('#hfzipstatus').val(data.status);
                            swal('Alert', 'Zip code is not valid for the State', 'error').then(function () {
                                swal.close();
                                $('#txtZipCode').focus();
                            });
                        }
                    }
                },

                error: function (error) {
                    swal('Error!', 'something went wrong', 'error');
                },
            })
        });
        $("#txtPhone").mask("(999) 999-9999");
    })
</script>