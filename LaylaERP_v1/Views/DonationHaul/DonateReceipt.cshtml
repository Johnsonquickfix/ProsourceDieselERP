
@{
    ViewBag.Title = "Donate Receipt Upload";
    //Layout = "~/Views/Shared/_Layout.cshtml";
    Layout = null;
}
<h2 class="lbl-tilte"  data-id="@ViewBag.id">Donate Receipt Upload</h2>
 

<section id="target" class="content section-content new-donate-section">
    <div id="divuploade" class="form-group d-flex profile-flex">
        <div class="col">
            <label class="control-label">Donate Receipt</label>
            <div class="add-profile">
                <span class="edit-pic-profile">
                    <input type="file" onchange="readURL(this);" name="ImageFile" id="ImageFile" class="inputfile" />
                    @*<label id="btnfiledonate" for="ImageFile"><i class="fa fa-edit"></i>Add</label>*@
                </span>
                <img runat="server" id="show_picture" height="300" class="profile-user-img img-responsive img-bordered" src="~/Content/ProductCategory/default.png" alt="Donate Receipt">
            </div>
        </div>

        <div class="col">
             <br />
                <textarea id="txtdescription" class="textarea" placeholder="Description"
                          style="width: 100%; height: 40px; font-size: 14px; line-height: 18px; border: 1px solid #dddddd; padding: 10px;"></textarea>

            
        </div>

        <div class="col">
            <br />
            <button id="btndonateuploade" title="Click here to upload" data-toggle="tooltip" style="float: left;" class="btn btn-danger">Upload</button>
        </div>
    </div>
</section>

<script src="~/Content/AdminLTE-3.1.0/jquery/jquery.min.js"></script>
@*<script src="~/js/common.js"></script>*@
<script type="text/javascript">
    //$(document).ready(function () {
    //    let _status = $('.lbl-tilte').data('status'), _id = parseInt($('.lbl-tilte').data('id')) || 0;
    //    if (_status == "Success") {
    //        $('.lbl-tilte').empty().append('Your order quote approved. <a title="Click here" href="' + window.location.origin + '">Click here</a>');
    //    }
    //    else { $('.lbl-tilte').empty().append(_status + ' <a title="Click here" href="' + window.location.origin + '">Click here</a>'); }
    //});
    $(document).ready(function () {
        id = parseInt($('.lbl-tilte').data('id')) || 0;
        console.log(id);
    $(document).on('click', "#btndonateuploade", function () {
        AdddonateImages();
       

    })

        
    });
    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#show_picture').attr('src', e.target.result);
            };
            reader.readAsDataURL(input.files[0]);

        }
    }
    function AdddonateImages() {
        var formData = new FormData();
        var ImageFile = document.getElementById("ImageFile").files[0];
        formData.append("ImageFile", ImageFile);
       // id = parseInt($('.lbl-tilte').data('id')) || 0;
        var cusmerid = $('.lbl-tilte').data('id');
        formData.append("cusmerid", cusmerid);
        var desc = $("#txtdescription").val();
        formData.append("desc", desc);

        if (ImageFile == "") {
            swal('Alert', 'Please upload files', 'error').then(function () { swal.close(); });
        }
        else {
           // ActivityLog('Attach file in Product list Kits & Buying Prices ', '/Product/AddNewProduct/');
            $.ajax({
                type: "POST",
                url: '/DonationHaul/FileUploade/',
                data: formData,
                processData: false,
                contentType: false,
                //beforeSend: function () {
                //    $("#loader").show();
                //},
                success: function (data) {
                    if (data.status == true) {
                        //if (data.url == "Manage") {
                        //    swal('Success!', data.message, 'success');

                        //}
                        //else {
                        //    swal('Success!', data.message, 'success');
                        //}
                       // <h2> 'Success' </h2>
                        $("#divuploade").hide();
                        $('.lbl-tilte').empty().append('Your receipt upload. <a title="Click here" href="' + window.location.origin + '">Click here</a>');
                        
                    }
                    else {
                       // <h2> error </h2>
                       // swal('Alert!', data.message, 'error')
                        $("#divuploade").hide();
                        $('.lbl-tilte').empty().append('Something wrong . <a title="Click here" href="' + window.location.origin + '">Click here</a>');
                    }
                },
                complete: function () {
                   // $("#loader").hide();
                },
                error: function (error) {
                    swal('Error!', 'something went wrong', 'error');
                },
            })
        }
    }
</script>