
@{
    ViewBag.Title = "Google Calendar Events";
    Layout = "~/Views/Shared/_Layout.cshtml";
}



<!-- Full Calendar -->
<link href="~/Content/fullcalendar/fullcalendar.css" rel="stylesheet" />
@*<link href='https://cdn.jsdelivr.net/npm/fullcalendar@3.10.5/dist/fullcalendar.min.css' rel='stylesheet' />
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@3.10.5/dist/fullcalendar.print.css' rel='stylesheet' media='print' />*@

<div id="loader" class="d-flex align-items-center">
    <img src="data:image/gif;base64,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" align="">
    <span>&nbsp;&nbsp;Loading......</span>
</div>

<div class="page-title">
    <h2>Google Calendar Events</h2>
</div>
<div class="row">
    <div class="col-md-12 col-md-push-0">
        <div class="box box-primary">
            <div class="box-body no-padding">
                <!-- THE CALENDAR -->
                <div id="eventcalendar"></div>
            </div>
        </div>
    </div><!-- /.col -->
</div>

<div class="modal in printable " id="eventModal" role="dialog" aria-hidden="true"></div>

<!-- Include moment-->
<script type="text/javascript" src="~/Content/AdminLTE-3.1.0/daterangepicker/moment.min.js"></script>
<!-- Full Calendar -->
<script type="text/javascript" src="~/Content/fullcalendar/fullcalendar.js"></script>
<script type='text/javascript' src="~/Content/fullcalendar/gcal.min.js"></script>


<script type="text/javascript">
    $(document).ready(function () {
        //Global variables to access the calendar
        var clientId = 'Your cliendID', scopes = 'https://www.googleapis.com/auth/calendar', calendarId = 'Your google calendar id', eventsList = [];
        $("#loader").hide();
        $('#eventcalendar').fullCalendar({
            themeSystem: 'bootstrap4', height: "100%", weekNumbers: false, firstDay: 0, selectable: true, defaultView: 'month',
            header: { left: 'prev,next today', center: 'title', right: 'month,agendaWeek,agendaDay,listMonth' },
            eventLimit: true, // allow "more" link when too many events
            //events: {
            //    googleCalendarApiKey: 'AIzaSyB9Y-aA-ZqG-WWi_48LPwYw2UZPc61I6Sc',
            //    googleCalendarId: 'johnson.quickfix@gmail.com',
            //    //googleCalendarId: 'en.usa#holiday@group.v.calendar.google.com',
            //    className: 'nice-event' // an option!
            //},
            //events: function (start, end, timezone, callback) {
            //    let option = {};
            //    $.ajax({
            //        url: 'https://www.googleapis.com/calendar/v3/calendars/johnson.quickfix@gmail.com/events?key=AIzaSyB9Y-aA-ZqG-WWi_48LPwYw2UZPc61I6Sc', type: "get", dataType: "JSON", data: option,
            //        success: function (result) {
            //            console.log(result);
            //            callback(result);
            //        },
            //        error: function (xhr, status, err) { console.log(xhr, status, err); }
            //    });
            //},
            googleCalendarApiKey: 'AIzaSyB9Y-aA-ZqG-WWi_48LPwYw2UZPc61I6Sc',
            eventSources: [
                { googleCalendarId: 'en.usa#holiday@group.v.calendar.google.com' },
                { googleCalendarId: 'addressbook#contacts@group.v.calendar.google.com' },
                { googleCalendarId: 'johnson.quickfix@gmail.com', className: 'nice-event' }
            ],
            editable: true,
            eventClick: function (calEvent, jsEvent, view) {
                let obj = {
                    id: calEvent.id, event_label: calEvent.event_label, start_date: moment(calEvent.start).format('MM/DD/YYYY'), end_date: moment(calEvent.end).format('MM/DD/YYYY'),
                    task: calEvent.title, description: calEvent.description, backgroundcolor: calEvent.backgroundColor, event_type: 0, assigned_to: calEvent.assigned_to
                }
                if (obj.assigned_to != "" && obj.assigned_to != null) {
                    obj.assigned_to = obj.assigned_to.split(",").map((el) => parseInt(el));
                    obj.event_type = 1;
                }
                //addEventModal(obj);

            },
            select: function (start, end, allDay) {
                //let obj = { id: 0, event_label: '', start_date: moment(start).format('MM/DD/YYYY'), end_date: moment(end).format('MM/DD/YYYY'), assigned_to: '', task: '', description: '', backgroundcolor: 'rgb(0, 115, 183)', event_type: 0 }
                //addEventModal(obj);
            },
            eventRender: function (event, element) { $(element).tooltip({ title: event.title }); }
        });
        $(document).on("change", "#ddleventtype", function (t) {
            t.preventDefault(); let id = parseInt($('#ddleventtype').val()) || 0;
            if (id > 0) { $('#ddluser').prop('disabled', false); }
            else { $('#ddluser').prop('disabled', true); }
        });
        $(document).on("click", "#btnAddNewEvent", function (t) {
            t.preventDefault(); AddEvents();
        });
        // Color chooser button
        $(document).on("click", "#color-chooser > li > a", function (e) {
            e.preventDefault(); var currColor = '#ff851b'; //Red by default
            // Save color
            currColor = $(this).css('color');
            $('#color-chooser').find('i').removeClass('fa-check-square'); $('#color-chooser').find('i').addClass('fa-square');
            $(this).find('i').removeClass('fa-square'); $(this).find('i').addClass('fa-check-square');
            // Add color effect to button
            $('#btnAddNewEvent').css({ 'background-color': currColor, 'border-color': currColor });
            $('#btnAddNewEvent').data('bgcolor', currColor);
        })
    });

    function addEventModal(obj) {
        let _Html = '<div class="modal-dialog">';
        _Html += '<div class="modal-content">';
        _Html += '<div class="modal-header">';
        _Html += '<button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i></button>';
        _Html += '<h4 class="modal-title" id="myModalLabel">Add Event</h4>';
        _Html += '</div>';
        _Html += '<div class="modal-body">';

        _Html += '<div class="row">';

        _Html += '<div class="col-md-4" >';
        _Html += '<div class="form-group">';
        _Html += '<label for="startdate">Start Date</label><span style="color:red">*</span>';
        _Html += '<input type="text" class="form-control" id="txtstartdate" disabled value="' + obj.start_date + '"/>';
        _Html += '</div>';
        _Html += '</div>';
        _Html += '<div class="col-md-4" >';
        _Html += '<div class="form-group">';
        _Html += '<label for="enddate">End Date</label><span style="color:red">*</span>';
        _Html += '<input type="text" class="form-control" id="txtenddate" value="' + obj.end_date + '"/>';
        _Html += '</div>';
        _Html += '</div>';
        _Html += '<div class="col-md-4" >';
        _Html += '<div class="form-group">';
        _Html += '<label for="enddate">Event Type</label><span style="color:red">*</span>';
        _Html += '<select class="form-control select2" id="ddleventtype" placeholder="Event Type" style="width: 100%;"><option value="1">Public</option><option value="0" selected>Private</option></select>';
        _Html += '</div>';
        _Html += '</div>';

        _Html += '</div >';

        _Html += '<div class="row">';
        _Html += '<div class="col-md-12" >';
        _Html += '<div class="form-group">';
        _Html += '<label for="task">Event Assigned To</label>';
        _Html += '<select class="form-control select2" id="ddluser" placeholder="Select user" multiple style="width: 100%;" disabled></select>';
        _Html += '</div>';
        _Html += '</div>';
        _Html += '</div >';

        _Html += '<div class="row">';
        _Html += '<div class="col-md-12" >';
        _Html += '<div class="form-group">';
        _Html += '<label for="task">Title</label><span style="color:red">*</span>';
        _Html += '<input type="text" class="form-control" id="txttask" maxlength="250" placeholder="Event Title" value="' + obj.task + '"/>';
        _Html += '</div>';
        _Html += '</div>';
        _Html += '</div >';

        _Html += '<div class="row">';
        _Html += '<div class="col-md-12" >';
        _Html += '<div class="form-group">';
        _Html += '<label for="enddate">Description</label>';
        _Html += '<textarea class="form-control" id="txtdescription" placeholder="Event Description" rows="3">' + obj.description + '</textarea>';
        _Html += '</div>';
        _Html += '</div>';
        _Html += '</div>';

        _Html += '<div class="btn-group" style="width: 100%; margin-bottom: 10px;">';
        _Html += '    <ul class="fc-color-picker" id="color-chooser">';
        _Html += '        <li><a class="text-aqua" href="#"><i class="fa fa-square"></i></a></li>';
        _Html += '        <li><a class="text-blue" href="#"><i class="fa fa-check-square"></i></a></li>';
        _Html += '        <li><a class="text-light-blue" href="#"><i class="fa fa-square"></i></a></li>';
        _Html += '        <li><a class="text-teal" href="#"><i class="fa fa-square"></i></a></li>';
        _Html += '        <li><a class="text-yellow" href="#"><i class="fa fa-square"></i></a></li>';
        _Html += '        <li><a class="text-orange" href="#"><i class="fa fa-square"></i></a></li>';
        _Html += '        <li><a class="text-green" href="#"><i class="fa fa-square"></i></a></li>';
        _Html += '        <li><a class="text-lime" href="#"><i class="fa fa-square"></i></a></li>';
        _Html += '        <li><a class="text-red" href="#"><i class="fa fa-square"></i></a></li>';
        _Html += '        <li><a class="text-purple" href="#"><i class="fa fa-square"></i></a></li>';
        _Html += '        <li><a class="text-fuchsia" href="#"><i class="fa fa-square"></i></a></li>';
        _Html += '        <li><a class="text-muted" href="#"><i class="fa fa-square"></i></a></li>';
        _Html += '        <li><a class="text-navy" href="#"><i class="fa fa-square"></i></a></li>';
        _Html += '    </ul>';
        _Html += '</div>';

        _Html += '</div > ';
        _Html += '<div class="modal-footer">';
        if ($('.page-title').data('ut').includes('administrator')) {
            _Html += '<button type="button" class="btn btn-danger" id="btnAddNewEvent" data-id="' + obj.id + '" data-bgcolor="' + obj.backgroundcolor + '">' + (obj.id > 0 ? 'Update' : 'Add') + '</button>';
        }
        else {
            if (obj.is_editable) {
                _Html += '<button type="button" class="btn btn-danger" id="btnAddNewEvent" data-id="' + obj.id + '" data-bgcolor="' + obj.backgroundcolor + '">' + (obj.id > 0 ? 'Update' : 'Add') + '</button>';
            }
            else {
                _Html += '<button class="btn btn-default" id="btnclose" data-dismiss="modal">Close</button>';
            }
        }
        _Html += '</div>';
        _Html += '</div>';
        _Html += '</div>';
        $("#eventModal").empty().html(_Html);
        $("#eventModal").modal({ backdrop: 'static', keyboard: false }); $("#txttask").focus();
        $('#txtstartdate,#txtenddate').datepicker({ format: 'mm/dd/yyyy', autoclose: true, todayHighlight: true });
        $('#ddleventtype,#ddluser').select2(); getUsers();
        $('#ddleventtype').val(obj.event_type).trigger('change');
        $('#ddluser').val(obj.assigned_to).trigger('change');
        if ($('.page-title').data('ut').includes('administrator')) {
            $('#txtenddate,#ddleventtype,#ddluser,#txttask,#txtdescription').prop('disabled', false);
        }
        else {
            if (obj.is_editable) {
                $('#txtenddate,#ddleventtype,#ddluser,#txttask,#txtdescription').prop('disabled', false);
            }
            else {
                $('#txtenddate,#ddleventtype,#ddluser,#txttask,#txtdescription').prop('disabled', true);
            }
        }

    }

    function getUsers() {
        $.ajax({
            url: "/Events/GetUsersList", type: "Get", beforeSend: function () { $("#loader").show(); },
            success: function (data) {
                let dt = JSON.parse(data);
                $.each(dt['Table'], function (i, row) { $("#ddluser").append('<option value="' + row.ID + '">' + row.user_login + '</option>'); });
            },
            complete: function () { $("#loader").hide(); },
            error: function (xhr, status, err) { $("#loader").hide(); }, async: false
        });
    }

    function AddEvents() {
        let startdate = $("#txtstartdate").val(), enddate = $("#txtenddate").val();
        let assignedto = $('#ddluser option:selected').toArray().map(item => item.value).join();
        let assigneduser = $('#ddluser option:selected').toArray().map(item => item.text).join();
        let task = $("#txttask").val(), description = $("#txtdescription").val(); backgroundcolor = '';

        if (startdate == "") { swal('Alert', 'Please enter start date', 'error').then(function () { swal.close(); $('#txtstartdate').focus(); }); }
        else if (enddate == "") { swal('Alert', 'Please enter end date', 'error').then(function () { swal.close(); $('#txtenddate').focus(); }); }
        else if (task == "") { swal('Alert', 'Please enter task', 'error').then(function () { swal.close(); $('#txttask').focus(); }); }
        else {
            var obj = { rowid: parseInt($("#btnAddNewEvent").data('id')) || 0, event_label: 'Event', start_date: startdate, end_date: enddate, assigned_to: assignedto, assigned_user: assigneduser, status: 1, task: task, description: description, backgroundcolor: $('#btnAddNewEvent').data('bgcolor') }
            let _event = obj.rowid > 0 ? 'UpdateEvents' : 'AddEvents';
            $.ajax({
                url: '/Events/' + _event, dataType: 'json', type: 'Post', contentType: "application/json; charset=utf-8",
                data: JSON.stringify(obj), beforeSend: function () { $("#loader").show(); },
                success: function (data) {
                    if (data.status == true) {
                        swal('Success', data.message, 'success').then((result) => { $("#eventModal").modal('hide'); $('#eventcalendar').fullCalendar('refetchEvents'); });
                    }
                    else { swal('Alert!', data.message, 'error'); }
                },
                complete: function () { $("#loader").hide(); },
                error: function (error) { swal('Error!', 'something went wrong', 'error'); },
            })

        }
    }
</script>
