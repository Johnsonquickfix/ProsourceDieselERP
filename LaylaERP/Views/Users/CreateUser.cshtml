
@{
    ViewBag.Title = "CreateUser";
    Layout = "~/Views/Shared/_UserLayout.cshtml";
}

<div class="page-title">
    <h2 class="page-heading">Create User</h2>
</div>
<div class="createuser-section section_wrapper">
    <div class="create-user-box">
        <div class="row">
            <div class="col-md-3">

                <!-- Profile Image -->
                <div class="box box-primary">
                    <div class="box-body box-profile">
                        <div class="user-box-profile">
                            <div class="add-profile">
                                <span class="edit-pic-profile">
                                    <input type="file" name="file" id="file" class="inputfile" />
                                    <label for="file"><i class="fa fa-edit"></i>Edit</label>
                                </span>
                                <img class="profile-user-img img-responsive img-circle" width="90" height="90" src="~/Images/userprofile2.png" alt="User profile picture">
                            </div>
                        </div>
                        <h3 class="profile-username text-center">Layla Sleep</h3>
                        <p class="text-muted text-center">laylasleep@acb.com</p>
                        <p class="text-center">Washington Dc</p>
                    </div>
                    <!-- /.box-body -->
                </div>
            </div>
            <!-- /.col -->
            <div class="col-md-9">
                    <div class="box box-primary create-user-primary">
                        <div class="box-header with-border">
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <input type="hidden" id="hfid" value="@ViewBag.id" />
                                    <label for="exampleInputEmail1">First Name</label>
                                    <input type="text" class="form-control" id="txtFirstName" placeholder="First Name">
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputEmail1">Last Name</label>
                                    <input type="text" class="form-control" id="txtLastName" placeholder="Last Name">
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputEmail1">User Status</label>
                                    <select class="form-control">
                                        <option>Select User Status</option>
                                        <option value="0">Active</option>
                                        <option value="1">InActive</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputEmail1">User Type</label>
                                    <select class="form-control" id="txtUserRole">
                                        <option>Select User Type</option>
                                        <option value="accounting">Accounting</option>
                                        <option value="administrator">Administrator</option>
                                        <option value="author">Author</option>
                                        <option value="modsquad">Mod Squad</option>
                                        <option value="seoeditor">SEO Editor</option>
                                        <option value="seomanager">SEO Manager</option>
                                        <option value="shopmanager">Shop manager</option>
                                        <option value="subscriber">Subscriber</option>
                                        <option value="supplychainmanager">Supply Chain Manager</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label for="exampleInputEmail1">Contact Number</label>
                                    <input type="text" class="form-control" id="txtPhone" placeholder="Enter Your Phone Number">
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputEmail1">Country</label>
                                    <select class="form-control" id="txtCountry">
                                        <option value="CA - Canada">CA - Canada</option>
                                        <option value="GB - United Kingdom">GB - United Kingdom</option>
                                        <option value="US - United States">US - United States</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputEmail1">Address</label>
                                    <textarea class="form-control form-address" id="txtAddress" placeholder="Enter Your Address"></textarea>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label for="exampleInputEmail1">E-mail</label>
                                    <input type="text" class="form-control" id="txtUserEmail" placeholder="Enter Your Mail Address">
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputEmail1">User Name</label>
                                    <input type="text" class="form-control" id="txtUserNickName" placeholder="Enter User Name">
                                </div>
                                <div class="form-group form-password-group">
                                    <label for="exampleInputEmail1">Password</label>
                                    <input type="password" class="form-control" id="txtPassword" placeholder="Enter Your Password">
                                    @*<span class="genrate_password">Genrate Password</span>*@
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputEmail1">Confirm Password</label>
                                    <input type="password" class="form-control" id="txtConfirmPassword" placeholder="Confirm Your Password">
                                </div>
                            </div>
                            <div class="col-offset-8 col-sm-4 mt-1" >
                                <a href="#" class="btn btn-danger btn-block" id="btnSave"><b>Create User</b></a>
                            </div>
                        </div>
                </div>
                <!-- /.nav-tabs-custom -->
            </div>
            <!-- /.col -->
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        $(document).on('click', "#btnSave", function () {
            AddCustomer();
        })
    });


    function AddCustomer() {
        debugger

        ID = $("#hfid").val();
        Email = $("#txtUserEmail").val();
        NickName = $("#txtUserNickName").val();
        FirstName = $("#txtFirstName").val();
        LastName = $("#txtLastName").val();
        address = $("#txtAddress").val();
        country = $("#txtCountry").val();
        UserRole = $("#txtUserRole").val();
        Password = $("#txtPassword").val();
        ConfirmPassword = $("#txtConfirmPassword").val();
        Phone = $("#txtPhone").val();

        if (Email == "") { swal('alert', 'Please Enter Email', 'error') }
        else if (NickName == "") { swal('alert', 'Please Enter Nick Name', 'error') }
        else if (FirstName == "") { swal('alert', 'Please Enter First Name', 'error') }
        else if (LastName == "") { swal('alert', 'Please Enter Last Name', 'error') }
        else if (address == "") { swal('alert', 'Please Enter Address', 'error') }
        else if (Password == "") { swal('alert', 'Please Enter Password', 'error') }
        else if (ConfirmPassword == "") { swal('alert', 'Please Enter Confirmpassword', 'error') }
        else if (Phone == "") { swal('alert', 'Please Enter Contact No.', 'error') }
        else {
            var obj = {
                ID: ID,
                user_email: Email,
                user_nicename: NickName,
                first_name: FirstName,
                last_name: LastName,
                address: address,
                country: country,
                phone: Phone,
                user_role: UserRole
            }
            $.ajax({
                url: '/Users/CreateUser/', dataType: 'json', type: 'Post',
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify(obj),
                dataType: "json",
                success: function (data) {
                    if (data.status == true) {
                        $('#parent > input:text').val('');
                        swal('Alert!', data.message, 'success');
                    }
                    else {
                        swal('Alert!', data.message, 'error')
                    }
                },
                error: function (error) {
                    swal('Error!', 'something went wrong', 'error');
                },
            })
        }

    }


    document.getElementById('txtBillingPhone').addEventListener('keyup', function (evt) {
        var phoneNumber = document.getElementById('txtBillingPhone');
        var charCode = (evt.which) ? evt.which : evt.keyCode;
        phoneNumber.value = phoneFormat(phoneNumber.value);
    });


    function phoneFormat(input) {
        input = input.replace(/\D/g, '');
        input = input.substring(0, 10);
        var size = input.length;
        if (size == 0) {
            input = input;
        } else if (size < 4) {
            input = '(' + input;
        } else if (size < 7) {
            input = '(' + input.substring(0, 3) + ') ' + input.substring(3, 6);
        } else {
            input = '(' + input.substring(0, 3) + ') ' + input.substring(3, 6) + ' - ' + input.substring(6, 10);
        }
        return input;
    }
    var input = document.querySelector("#txtBillingPhone");
    window.intlTelInput(input, {
        // allowDropdown: false,
        // autoHideDialCode: false,
        // autoPlaceholder: "off",
        // dropdownContainer: document.body,
        // excludeCountries: ["us"],
        // formatOnDisplay: false,
        // geoIpLookup: function(callback) {
        //   $.get("http://ipinfo.io", function() {}, "jsonp").always(function(resp) {
        //     var countryCode = (resp && resp.country) ? resp.country : "";
        //     callback(countryCode);
        //   });
        // },
        // hiddenInput: "full_number",
        // initialCountry: "auto",
        // localizedCountries: { 'de': 'Deutschland' },
        // nationalMode: false,
        // onlyCountries: ['us', 'gb', 'ch', 'ca', 'do'],
        // placeholderNumberType: "MOBILE",
        // preferredCountries: ['cn', 'jp'],
        // separateDialCode: true,
        utilsScript: "~/Scripts/intlTelInput.js",
    });

    //$('#txtPassword, #txtConfirmPassword').on('keyup', function () {
    //    if ($('#txtPassword').val() == $('#txtConfirmPassword').val()) {
    //        $('#message').html('Matching').css('color', 'green');
    //    } else
    //        $('#message').html('Not Matching').css('color', 'red');
    //});

</script>